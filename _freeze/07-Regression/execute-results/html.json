{
  "hash": "a1560f65cada5ef68af270df40bb7d2c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Regression\"\nsubtitle: \"Estimating models and predicting values with R\"\nformat: revealjs\n---\n\n\n\n## Prerequisite {background-image=\"images/bg-h1-3.jpg\"}\n\nYou have basic knowledge on statistical regression\n\n## Goal {background-image=\"images/bg-h1-3.jpg\"}\n\nYou know how to fit regression models in R\n\n## Regression\n\n::: incremental\n-   In a statistical regression you explain a variable (criteria or dependent variable) by one or more other variables (predictors or independent variables).\n-   You *regress* the criteria variable on the predictor variables.\n-   E.g.: You want to explain the *life expectancy* by certain aspects of behavior (diet, physical activity), environmental aspects (pollution, health care).\n-   Therefore, you try to set up a mathematical function which tries to estimate what *life expectancy* a person has given all the other variables.\n:::\n\n## Regression formula\n\n::: left\n$y_i = \\beta_0 + \\beta_1X_i + e_i$\n\n$y$ = Criteria variable\\\n$i$ = Subject number (measurement number)\\\n$\\beta_0$ = Intercept of $y$\\\n$\\beta_1$ = Weight of predictor $X$\\\n$X$ = Predictor variable\\\n$e$ = Error term\n:::\n\n::: right\n\n::: {.cell}\n::: {.cell-output-display}\n![](07-Regression_files/figure-revealjs/unnamed-chunk-1-1.png){width=480}\n:::\n:::\n\n:::\n\n## `lm()` function\n\n-   The `lm()` function fits a regression model.\n-   `lm(formula, data)`\n-   ***Formulas*** are a basic data type that is applied in many R functions.\n-   Basic structur: ***dependent variable \\~ explanatory variables***\\\n    (e.g. ***y \\~ x1 + x2***)\n-   `data` takes a dataframe\n\n`lm(dist ~ speed, data = cars)`\n\n## Example\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](07-Regression_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n\n\n## Example\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](07-Regression_files/figure-revealjs/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n## Example\n\n::: left\n\n::: {.cell}\n::: {.cell-output-display}\n![](07-Regression_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n:::\n\n::: right\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- lm(dist ~ speed, data = cars)\nfit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = dist ~ speed, data = cars)\n\nCoefficients:\n(Intercept)        speed  \n    -17.579        3.932  \n```\n\n\n:::\n:::\n\n:::\n\n$dist_i = -17.579 + 3.932 * speed_i$\n\n## Use `summary()` to get detailed analyses\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = dist ~ speed, data = cars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.069  -9.525  -2.272   9.215  43.201 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -17.5791     6.7584  -2.601   0.0123 *  \nspeed         3.9324     0.4155   9.464 1.49e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 15.38 on 48 degrees of freedom\nMultiple R-squared:  0.6511,\tAdjusted R-squared:  0.6438 \nF-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12\n```\n\n\n:::\n:::\n\n\nModelfit:\\\n$F(1, 48) = 89.57; p < .001 ; R² = .65$\n\n## Task\n\n-   Take the `mtcars` dataset.\n-   Calculate the correlation of mileage `mpg` and car weight `wt`.\n-   Plot a scatterplot with ggplot (mileage on the x-axis and weight on the y-axis).\n-   Add a regression line with (`geom_smooth(method = \"lm\")`).\n-   Regress mileage `mpg` on car weight `wt` (that is, predict mileage by means of weight).\n\n## \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(mtcars$mpg, mtcars$wt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -0.8676594\n```\n\n\n:::\n\n```{.r .cell-code}\nfit <- lm(mpg ~ wt, data = mtcars)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = mpg ~ wt, data = mtcars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.5432 -2.3647 -0.1252  1.4096  6.8727 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  37.2851     1.8776  19.858  < 2e-16 ***\nwt           -5.3445     0.5591  -9.559 1.29e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.046 on 30 degrees of freedom\nMultiple R-squared:  0.7528,\tAdjusted R-squared:  0.7446 \nF-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10\n```\n\n\n:::\n:::\n\n\n## \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mtcars, aes(x = mpg, y = wt)) + \n  geom_point() + \n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](07-Regression_files/figure-revealjs/unnamed-chunk-8-1.png){width=384}\n:::\n:::\n\n\n## Task\n\n-   Take the `temp_carbon` dataset from the `dslabs` library.\n-   Make yourself familiar with the dataset: `?temp_carbon`.\n-   Plot a scatterplot with ggplot (year on the x-axis and temp_anomaly on the y-axis).\n-   Add a regression line with (`geom_smooth(method = \"lm\")`).\n-   Regress `temp_anomaly` on `year` (that is, predict temp_anomaly by means of year).\n\n## \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dslabs)\nfit <- lm(temp_anomaly ~ year, \n          data = temp_carbon)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = temp_anomaly ~ year, data = temp_carbon)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.32598 -0.11846 -0.01062  0.11185  0.43367 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -1.409e+01  6.750e-01  -20.87   <2e-16 ***\nyear         7.259e-03  3.463e-04   20.96   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1638 on 137 degrees of freedom\n  (129 observations deleted due to missingness)\nMultiple R-squared:  0.7623,\tAdjusted R-squared:  0.7606 \nF-statistic: 439.4 on 1 and 137 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n## \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(temp_carbon, aes(x = year, \n                        y = temp_anomaly)) + \n  geom_point() + \n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](07-Regression_files/figure-revealjs/unnamed-chunk-10-1.png){width=384}\n:::\n:::\n\n\n## Multiple predictors\n\n-   A `formula` can take multiple predictors:\\\n    `y ~ x1 + x2`\n-   An Interaction describes a relation between two (or more) predictors where the influence of one predictor changes with the value of the other predictor (e.g. weight and smoking influence blood pressure. And the influence of smoking is even higher for those who are overweight).\n-   An interaction is modeled with a `:` sign:\\\n    y \\~ x1 + x2 + x1:x2\n\n## Example\n\nPredict mileage `'mpg'` by weight `'wt'` and number of cylinders `'cyl'` and its interaction\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- lm(mpg ~ wt + cyl + wt:cyl, data = mtcars)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = mpg ~ wt + cyl + wt:cyl, data = mtcars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.2288 -1.3495 -0.5042  1.4647  5.2344 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  54.3068     6.1275   8.863 1.29e-09 ***\nwt           -8.6556     2.3201  -3.731 0.000861 ***\ncyl          -3.8032     1.0050  -3.784 0.000747 ***\nwt:cyl        0.8084     0.3273   2.470 0.019882 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.368 on 28 degrees of freedom\nMultiple R-squared:  0.8606,\tAdjusted R-squared:  0.8457 \nF-statistic: 57.62 on 3 and 28 DF,  p-value: 4.231e-12\n```\n\n\n:::\n:::\n\n\n## Task\n\n-   Take the `gapminder` dataset from the `dslabs` library.\n-   Predict infant mortality (`infant_mortality`) by year (`year`) and average number of children per woman (`fertility`).\n-   Take the interaction into account.\n-   How to interpret the estimates?\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dslabs)\nfit <- lm(infant_mortality ~ year + fertility + fertility:year, data = gapminder)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = infant_mortality ~ year + fertility + fertility:year, \n    data = gapminder)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-81.327 -11.540  -1.282  11.575 141.101 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    -5.902e+02  8.588e+01  -6.873 6.72e-12 ***\nyear            2.872e-01  4.308e-02   6.666 2.77e-11 ***\nfertility       3.574e+02  1.869e+01  19.130  < 2e-16 ***\nyear:fertility -1.708e-01  9.404e-03 -18.168  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 25.84 on 9088 degrees of freedom\n  (1453 observations deleted due to missingness)\nMultiple R-squared:  0.7071,\tAdjusted R-squared:  0.707 \nF-statistic:  7312 on 3 and 9088 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n-   Although the previous computation is correct (!). The estimates is misleading. The intercept, for example, depicts the average dependent variable when all predictors are zero (i.e. year is 0 and fertility is 0).\n-   We can mend this by centering the predictor variables.\n-   Centering is achieved by subtracting the mean of a variable from each measurement of that variable. That is, the value 0 now depicts the average.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- gapminder\ndat$year <- dat$year - mean(dat$year, na.rm = TRUE)\n# alternatively, use the scale function to center a variable:\ndat$fertility <- scale(dat$fertility, scale = FALSE)\n```\n:::\n\n\n------------------------------------------------------------------------\n\n::: left\n\n::: {.cell}\n::: {.cell-output-display}\n![](07-Regression_files/figure-revealjs/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n\n:::\n\n::: right\n\n::: {.cell}\n::: {.cell-output-display}\n![](07-Regression_files/figure-revealjs/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- gapminder\ndat$year <- scale(dat$year, scale = FALSE)\ndat$fertility <- scale(dat$fertility, scale = FALSE)\nfit <- lm(infant_mortality ~ year + fertility + fertility:year, data = dat)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = infant_mortality ~ year + fertility + fertility:year, \n    data = dat)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-81.327 -11.540  -1.282  11.575 141.101 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    53.452151   0.304781  175.38   <2e-16 ***\nyear           -0.410454   0.019561  -20.98   <2e-16 ***\nfertility      17.796992   0.150837  117.99   <2e-16 ***\nyear:fertility -0.170849   0.009404  -18.17   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 25.84 on 9088 degrees of freedom\n  (1453 observations deleted due to missingness)\nMultiple R-squared:  0.7071,\tAdjusted R-squared:  0.707 \nF-statistic:  7312 on 3 and 9088 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n## Categorical predictors: comparing groups\n\n-   Predictors can be categorical variables.\n-   Examples of categorical variables are: students with vs. without special educational needs; gender; Haircolor.\n-   They have to be `factors` to recognize them as `categorical`.\n\n## Example\n\n-   We predict `mpg` by `wt` and the transmission type `am` and their interaction.\n-   The transmission type is a categorical variable. By default `am` is not a factor. So we have to turn `am` into a factor first.\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars$wt_centered <- scale(mtcars$wt, scale = FALSE)\nmtcars$am_factor <- factor(mtcars$am, labels = c(\"Automatic\", \"Manual\"))\nfit <- lm(mpg ~ wt_centered + am_factor + wt_centered:am_factor, data = mtcars)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = mpg ~ wt_centered + am_factor + wt_centered:am_factor, \n    data = mtcars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.6004 -1.5446 -0.5325  0.9012  6.0909 \n\nCoefficients:\n                            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                  19.2358     0.7357  26.147  < 2e-16 ***\nwt_centered                  -3.7859     0.7856  -4.819 4.55e-05 ***\nam_factorManual              -2.1677     1.4189  -1.528  0.13779    \nwt_centered:am_factorManual  -5.2984     1.4447  -3.667  0.00102 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.591 on 28 degrees of freedom\nMultiple R-squared:  0.833,\tAdjusted R-squared:  0.8151 \nF-statistic: 46.57 on 3 and 28 DF,  p-value: 5.209e-11\n```\n\n\n:::\n:::\n\n\n## Task\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheights$sex <- factor(heights$sex)\nfit <- lm(height ~ sex, data = heights)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = height ~ sex, data = heights)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-19.3148  -2.3148  -0.3148   2.6852  14.0606 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  64.9394     0.2363  274.82   <2e-16 ***\nsexMale       4.3753     0.2687   16.28   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.645 on 1048 degrees of freedom\nMultiple R-squared:  0.2019,\tAdjusted R-squared:  0.2012 \nF-statistic: 265.1 on 1 and 1048 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n## Contrasts\n\n-   In the previous example, we compared the effect of an automatic against a manual gearshift. This is called a **contrast**. In this case, our intercept represented the *mpg* for the automatic gearshift and the predictor represented the change in the *mpg* values for manual gearshifts.\n\n-   This type of contrast is called a \"treatment\" contrast.\n\n-   An alternative approach would be to calculate the average of 'mpg' across both types of gearshifts and the predictor represents how much the type of gearshift influences 'mpg'.\n\n-   This type of contrast is called a Helmert contrast.\n\n## Example\n\nFitting `lm(mpg ~ am_factor, data = mtcars)` with a treatment contrast:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n    (Intercept) am_factorManual \n      17.147368        7.244939 \n```\n\n\n:::\n:::\n\n\nFitting `lm(mpg ~ am_factor, data = mtcars)` with a Helmert contrast:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)  am_factor1 \n   20.76984     3.62247 \n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n-   The `constrasts()` function gets and sets contrasts for factors\n-   Treatment contrasts for two factor levels:\\\n\n``` r\ncontrasts(mtcars$am_factor) <- contr.treatment(2)\n```\n\n-   Helmert contrasts for two factor levels:\\\n\n``` r\ncontrasts(mtcars$am_factor) <- contr.helmert(2)\n```\n\n## Task {.smaller}\n\n-   Take the `mtcars` dataset\n-   Predict `mpg` by `wt` and the transmission type `am` and their interaction\n-   By default `am` is not a factor. Please create a factor `transmission` for `am` first\n-   Set the contrasts of the factor to *Helmert* and calculate the model.\n-   Set the contrasts of the factor to *Treatment* and calculate the model\n-   Compare the results of the two models and discuss them with you seatmate\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars$transmission <- factor(mtcars$am, labels = c(\"Automatic\", \"Manual\"))\nmtcars$wt_centered <- scale(mtcars$wt, scale = FALSE)\ncontrasts(mtcars$transmission) <- contr.helmert(2)\nfit1 <- lm(mpg ~ wt_centered + transmission + wt_centered:transmission, data = mtcars)\nsummary(fit1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = mpg ~ wt_centered + transmission + wt_centered:transmission, \n    data = mtcars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.6004 -1.5446 -0.5325  0.9012  6.0909 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                18.1520     0.7094  25.586  < 2e-16 ***\nwt_centered                -6.4351     0.7223  -8.909 1.16e-09 ***\ntransmission1              -1.0839     0.7094  -1.528  0.13779    \nwt_centered:transmission1  -2.6492     0.7223  -3.667  0.00102 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.591 on 28 degrees of freedom\nMultiple R-squared:  0.833,\tAdjusted R-squared:  0.8151 \nF-statistic: 46.57 on 3 and 28 DF,  p-value: 5.209e-11\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontrasts(mtcars$transmission) <- contr.treatment(2)\nfit2 <- lm(mpg ~ wt_centered + transmission + wt_centered:transmission, data = mtcars)\nsummary(fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = mpg ~ wt_centered + transmission + wt_centered:transmission, \n    data = mtcars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.6004 -1.5446 -0.5325  0.9012  6.0909 \n\nCoefficients:\n                          Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                19.2358     0.7357  26.147  < 2e-16 ***\nwt_centered                -3.7859     0.7856  -4.819 4.55e-05 ***\ntransmission2              -2.1677     1.4189  -1.528  0.13779    \nwt_centered:transmission2  -5.2984     1.4447  -3.667  0.00102 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.591 on 28 degrees of freedom\nMultiple R-squared:  0.833,\tAdjusted R-squared:  0.8151 \nF-statistic: 46.57 on 3 and 28 DF,  p-value: 5.209e-11\n```\n\n\n:::\n:::\n\n\n## Design example {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sjPlot)\ntab_model(fit1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">mpg</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">18.15</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">16.70&nbsp;&ndash;&nbsp;19.61</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">wt centered</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;6.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;7.91&nbsp;&ndash;&nbsp;-4.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">transmission [1]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.08</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.54&nbsp;&ndash;&nbsp;0.37</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.138</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">wt centered ×<br>transmission [1]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.65</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;4.13&nbsp;&ndash;&nbsp;-1.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">32</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.833 / 0.815</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n##  {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_model(fit1, fit2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">mpg</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">mpg</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">CI</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7\">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">18.15</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">16.70&nbsp;&ndash;&nbsp;19.61</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">19.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">17.73&nbsp;&ndash;&nbsp;20.74</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">wt centered</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;6.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;7.91&nbsp;&ndash;&nbsp;-4.96</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.79</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;5.40&nbsp;&ndash;&nbsp;-2.18</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">transmission [1]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.08</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.54&nbsp;&ndash;&nbsp;0.37</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.138</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">wt centered ×<br>transmission [1]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.65</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;4.13&nbsp;&ndash;&nbsp;-1.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">transmission [2]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;5.07&nbsp;&ndash;&nbsp;0.74</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\">0.138</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">wt centered ×<br>transmission [2]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;5.30</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;8.26&nbsp;&ndash;&nbsp;-2.34</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">32</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.833 / 0.815</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.833 / 0.815</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n##  {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab_model(fit1, fit2,\n  show.ci = FALSE, show.se = TRUE,string.se = \"se\", string.est = \"B\",\n  dv.labels = c(\"Model with helmert contrast\", \"Model with treatment contrast\")\n)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Model with helmert contrast</th>\n<th colspan=\"3\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Model with treatment contrast</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">B</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">se</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">B</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">se</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7\">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">(Intercept)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">18.15</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.71</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">19.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.74</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">wt centered</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;6.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.72</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.79</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.79</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">transmission [1]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.08</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.71</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.138</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">wt centered ×<br>transmission [1]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.65</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.72</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.001</strong></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">transmission [2]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.17</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.42</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\">0.138</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">wt centered ×<br>transmission [2]</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"></td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;5.30</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7\"><strong>0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"3\">32</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.833 / 0.815</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"3\">0.833 / 0.815</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n# Multilevel regressions {background-image=\"images/bg-h1-3.jpg\"}\n\n## Multilevel regression formula\n\n$y_{ij} = \\beta_{0j} + \\beta_{1j} X_{ij} + e_{ij}$\n\nLevel 2:\\\n$\\beta_{0j} = \\gamma_{01}W_j + \\upsilon_{0j}$\\\n$\\beta_{1j} = \\gamma_{10} + \\upsilon_{1j}$\n\n$y$ = Criteria variable\\\n$i$ = Subject number (measurement number)\\\n$\\beta_0$ = Intercept of $y$\\\n$\\beta_1$ = Weight of predictor $X$\\\n$X$ = Predictor variable\\\n$e$ = Error term\\\n$j$ = Level 2 group number\\\n$\\gamma_{00}$ = Intercept\\\n$W$ = Level 2 predictor (grouping variable)\\\n$\\gamma_{01}$ = Weight for $W$\\\n$\\gamma_{10}$ = Weight of the predictor\\\n$\\upsilon_{0j}$ = Error term for intercept \n$\\upsilon_{0j}$ = Error term for slope\n",
    "supporting": [
      "07-Regression_files/figure-revealjs"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}